1. 概述
1.1 五层协议
物理层————————》数据链路层————————》网络层(IP)————————》传输层（TCP）————————》应用层（HTTP）
1.2 层与协议
每一层为了完成一种功能，都要遵守共同规则。大家都遵守的规则，就叫“协议”

2. 物理层
把电脑连起来，用光缆、电缆、双绞线、无线电波等方式。
这就叫“物理层”，把电脑连接起来的物理手段。主要规定了网络的一些电器特性，作用是负责传送0和1的电信号。

3. 数据链路层
3.1 定义
解读“物理层”传送来的电信号。确定0和1的分组方式。

3.2 以太网协议
以太网规定，一组电信号构成一个数据包，叫做“帧”。每一帧分成两个部分：标头和数据
“标头”包含数据包的一些说明项，比如发送者、接收者、数据信息；“数据”则是数据包的具体内容。
“标头”的长度固定为18个字节。“数据”的长度46~1500字节。

3.3 MAC地址
以太网规定，连接网络的所有设备都必须具有“网卡”接口。数据包必须是从一个网卡，传送到另一个网卡。网卡的地址，就是数据包的发送地址和接收地址，这叫MAC地址。每个网卡出厂的时候，都有一个全世界独一无二的MAC地址。

3.4 广播
首先，一个网卡怎么知道另一块网卡的MAC地址？
只能在同一个子网络下才能广播。  

现在交换机会记录并缓存各个交换机端口连接的设备的MAC地址，转发包时会按缓存的地址表转发到特定的交换机端口，除非地址表里面没有目的MAC地址，不然不会广播包。

4. 网络层
4.1 网络层的由来
需要找到一种方法，能够区分哪些MAC地址属于同一个子网络。哪些不是。如果是同一个子网络，就采用广播方式发送，否则就采用“路由”方式发送。MAC地址无法做到这一点。
这就导致了“网络层”的诞生。它的作用是引进一套新的地址，使得我们能够区分不同的计算机是否属于同一个子网络。这套地址就叫做“网络地址”，简称“网址”。
于是，“网络地址”出现以后，每台计算机有了两种地址，一种是MAC地址，另一种是网络地址。两种地址之间没有任何联系，MAC地址是绑定在网卡上的，网络地址是管理员分配的，它们只是随机组合在一起。

网络地址帮助我们确定计算机所在的子网络，MAC地址则将数据包送到改子网络中的目标网卡。
路由：指如何向不同的子网络分发数据包

4.2 IP协议
规定网络地址的协议，叫做IP协议。它所定义的地址，就被称为IP地址。
IP协议的作用主要有两个，一个是为每一台计算机分配IP地址，另一个是确定哪些地址在同一个子网络。

4.3 IP数据包
根据ip协议发送的数据，就叫做IP数据包。
前面说过，以太网数据包的标头只包含MAC地址，并没有IP地址栏。我们可以把IP数据包直接放进以太网数据包的“数据”里。

IP数据包也分为“标头”和数据两个部分

4.4 ARP协议
ARP协议，通过IP地址就是得到同一个子网络内的主机MAC地址，可以把数据包发送到任意一台主机之上了。

如果两台主机不在同一个子网络，那么事实上没有办法得到对方的MAC地址，只能把数据包传送到两个子网络连接处的“网关”，网关处理。
如果两台主机在同一个子网络，那么我们可以用ARP协议，得到对方的MAC地址。ARP协议也是发送一个数据包（包含以太网数据包中），其中包含它所需要查询主机的IP地址，在对方的MAC地址这一栏填的是FF:FF:FF:FF:FF:FF，表示一个广播地址。它所在的子网络的每一台主机，都会收到这个数据包，从中取出IP地址，与自身的IP地址进行比较。如果两者相同，都做出回复，向对方报告自己的MAC地址，否则就丢弃这个包。

5. 传输层
5.1 传输层的由来
有了MAC地址和IP地址，我们已经可以在互联网上任意两台主机上建立通信。

接下来的问题是，同一台主机上有许多程序都需要用到网络，当一个数据包从互联网上发来的时候，怎么知道，它是网页内容，还是在线聊天的内容？

也就是说，我们还需要一个参数，表示这个数据包到底供那个程序（进程）使用。这个参数就叫做“端口”，它其实是每一个使用网卡的程序的编号。

“传输层”的功能，就是建立“端口到端口”的通信。相比之下，“网络层”的功能是建立“主机到主机”的通信。只要确定主机和端口，我们就能实现程序之间的交流。因此，Unix系统就把主机+端口，叫做“套接字”（socket）。有了它，就可以进行网络应用程序开发了。

5.2 UDP协议
现在，我们必须在数据包中加入端口信息，这就需要新的协议。最简单的实现叫做UDP协议，它的格式就是在数据前面加上端口号。
UDP数据包:也是由“标头”和数据两部分组成。“标头”部分主要定义了发出端口和接收端口，“数据部分”包含具体的内容。然后把整个UDP数据包放入IP数据包的“数据”部分。
UDP数据包非常简单，“标头部分”一共只有8个字节，总长度不超过65535字节。

5.3 TCP协议
UDP协议的优点是比较简单，容易实现，但是缺点是可靠性差，一旦数据包发出，无法知道对方是否收到。

为了提高网络可靠性，TCP协议就出现了。TCP协议要求每发出一个数据包都要求确认。如歌一个数据包遗失，就收不到确认，发出方就知道有必要重发这个数据包了。

6. 应用层
应用层收到“传输层”的数据，接下来就要进行解读。
“应用层”的作用就是规定应用程序的数据格式。
6.1 HTTP协议
HTTP协议没有数据包，它主要规定了客户端和服务端之间通信的格式。
HTTP协议以明文方式发送内容，不提供任何方式的数据加密。因此，http协议不适合传输一些敏感的信息。
为了解决HTTP协议这一个缺陷，需要使用另一种协议：安全套接字层超文本传输协议HTTPS，为了数据传输安全，HTTPS协议在HTTP基础上加入了SSL协议，SSL依靠证书验证服务器的身份，并为浏览器和服务器之间的通信加密。
6.2 HTTP协议的发展
（1）HTTP/0.9: 改版本比较简单，只有一个请求命令Get,服务器回应的格式也只能是HTML格式的字符串。
（2）HTTP/1.0:
    1. 服务器回应的格式：任何格式都可以发送，除了传输文字外，还可以传输图像、影片、二进制文件；
    2. 请求命令：除了get外，有添加了POST和HEAD命令
    3. HTTP请求和回应的格式也变了：除了数据部分，每次通信必须包括头信息（Http header）
    4. 新增的功能还包括状态码、多字符集支持、多部分发送、权限、缓存（cache)、内容编码（content encoding)

    缺点：每个TCP连接只能发送一个请求。
（3）HTTP/1.1
    1. 持久连接：即TCP连接默认不关闭，可以被多个请求复用，不用声明Connection: keep-alive。客户端和服务器发现对方一段时间没有活动，
    就可以主动关闭连接。不过，客户端最后一个请求时，发送Connection: close，明确要求服务器关闭TCP连接。
    2. 管道机制：即在同一个tcp连接里面，客户端可以同时发送多个请求。管道机制则是允许服务器同时发送A请求和B请求，但是服务器还是按照顺序，先回应A请求，完成后在回应B请求。
    3. content-length: 一个tcp连接现在可以传送多个回应，势必就要有一种机制，区分数据包是属于哪一个回应。
    4. 分块传输编码： Transfer-Encoding: chunked。只要请求或回应的头信息有Transfer-Encoding字段，就表明回应将有数量未定的数据块组成。
    5. 其他功能：新增了许多动词方法：put、patch、head、options、delete;另外客户端请求头信息新增了HOST字段，用来指定服务器的域名。

    缺点：1.1版允许复用TCP连接，但是同一个TCP连接里面，所有的数据通信是按次序进行的。服务器只有处理完一个回应，才会进行下一个回应。要是前面的回应特别慢，后面就会有许多请求排队等着。这称为“队头堵塞”。
    为了避免这个问题，只有两种方法：一是减少HTTP请求，二是同时多开几个持久连接。

（4）HTTP/2:
     1. 二进制协议：HTTP/2是一个彻底的二进制协议，头信息和数据体都是二进制，并且统称为“帧”，头信息帧和数据帧。
     2. 多工：复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，而且不用按照顺序---对应，这样就避免了”队头堵塞“。
     3. 数据流：HTTP/2将每个请求或回应的所有数据包，称为一个数据流。每个数据流都有一个独一无二的编号，另外规定，客户端发出的数据流，ID一律为奇数，服务器发出的ID为偶数。
     4. 头信息压缩：HTTP每次请求都必须附上所有信息，比如cookie和user agent,一模一样的内容，每次请求附带，这样很浪费带宽，也影响速度。HTTP/2对这点做了优化，引入头信息压缩机制。
     5. 服务器推送： HTTP/2允许服务器未经请求，主动向客户端发送资源，这叫服务器推送。



6.3 HTTPS协议： 简单讲是HTTP协议的安全版。
    HTTPS协议的主要作用可以分为两种：一种是建立一个信息安全通道，来保证数据传输安全；另一种就是确认网站的真实性。     